<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="json/Manifest.json">
    <link rel="stylesheet" href="Css/Mystyle.css">
    <title>Fusion Insights</title>
    <!--Boostrap Link-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!--Google Map Link-->
  <script async src="https://maps.googleapis.com/maps/api/js?key=Your-Api-Key&loading=async&libraries=maps&callback=initMap"></script>
  <!--Icon Media_Capture link Link-->
   <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script type="module" src="https://unpkg.com/@material/mwc-button@mwc-2.0.0/mwc-button.js"></script>
</head>
<body>

  <div class="content container-fluid">
    <div class="container-fluid"><h1>Welcome to Fusion Insights </h1></div>
    <button id="install-btn">Install App</button>
    <div class="GoogleMap" id="map"></div>

    <section class="VideoOnly">
      <web-cam>
          <div id="container">
              <div id="video-container">
                  <video id="front-camera" autoplay="" playsinline=""></video>
                  <video id="rear-camera" autoplay="" playsinline=""></video>
              </div>
              <div id="preview-container"></div>
              <div id="video-buttons"></div>
              <button id="init-video">
                  <i class="material-icons">video_call</i>
              </button>
              <button>
                  <i class="material-icons">switch_video</i>
              </button>
              <button>
                  <i class="material-icons">power_settings_new</i>
              </button>

          </div>
      </web-cam>
  </section>
  <div id="modal" class="modal">
      <p>No access to Media</p>
      <button id="close-modal">Close</button>
  </div>

  </div>
      


     <!--   Javascript below    -->
    <script src="JS/app.js"></script>  
    <script src="JS/Gmap.js"></script>

    <script>
      // Function to initialize video stream
      async function initVideo() {
          try {
              // Request access to the front camera
              const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });

              // Get the video element
              const videoElement = document.getElementById('front-camera');

              // Set the video source to the stream and show the video
              videoElement.srcObject = stream;
              videoElement.style.display = 'block'; // Show the front camera video
              videoElement.classList.add('initialized'); // Add 'initialized' class
          } catch (error) {
              // If permission is denied, show the modal
              showModal();
          }
      }

      // Function to show the modal
      function showModal() {
          const modal = document.getElementById('modal');
          modal.style.display = 'block'; // Show the modal
      }

      // Close modal button event listener
      document.getElementById('close-modal').addEventListener('click', () => {
          const modal = document.getElementById('modal');
          modal.style.display = 'none'; // Hide the modal
      });

      // Event listener for the button
      document.getElementById('init-video').addEventListener('click', () => {
          initVideo(); // Directly call initVideo when the button is clicked
      });




   
      
    let stream = null; // Store the active stream
    let currentCamera = 'user'; // Default to the front camera (facingMode: "user")

    // Function to initialize video stream for both cameras
    async function initVideo() {
        try {
            // Request access to the front camera (facingMode: "user")
            stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: currentCamera } });

            // Get the video elements
            const frontCamera = document.getElementById('front-camera');
            const rearCamera = document.getElementById('rear-camera');

            // Assign the stream to the front camera video element
            frontCamera.srcObject = stream;
            rearCamera.srcObject = stream;

            // Add the 'initialized' class to both cameras
            frontCamera.classList.add('initialized');
            rearCamera.classList.add('initialized');

            // Display the front camera by default, and hide the rear camera
            frontCamera.style.display = 'block';
            rearCamera.style.display = 'none';
        } catch (error) {
            showModal(); // If permission is denied, show the modal
        }
    }

    // Function to switch between front and rear cameras
    function toggleCamera() {
        const videoContainer = document.getElementById('video-container');
        const frontCamera = document.getElementById('front-camera');
        const rearCamera = document.getElementById('rear-camera');

        if (currentCamera === 'user') {
            // Switch to the rear camera
            currentCamera = 'environment';
            videoContainer.classList.add('rear-view'); // Add rear-view class to the container
            frontCamera.style.display = 'none'; // Hide front camera
            rearCamera.style.display = 'block'; // Show rear camera
        } else {
            // Switch back to the front camera
            currentCamera = 'user';
            videoContainer.classList.remove('rear-view'); // Remove rear-view class from the container
            frontCamera.style.display = 'block'; // Show front camera
            rearCamera.style.display = 'none'; // Hide rear camera
        }
    }

    // Function to stop the video stream
    function stopVideo() {
        if (stream) {
            const tracks = stream.getTracks();
            tracks.forEach(track => track.stop()); // Stop all tracks
        }
        stream = null;

        // Hide both cameras
        document.getElementById('front-camera').style.display = 'none';
        document.getElementById('rear-camera').style.display = 'none';

        // Remove the 'initialized' class from both cameras
        document.getElementById('front-camera').classList.remove('initialized');
        document.getElementById('rear-camera').classList.remove('initialized');
    }

    // Function to show the modal
    function showModal() {
        const modal = document.getElementById('modal');
        modal.style.display = 'block'; // Show the modal
    }

    // Initialize the video on clicking the start button
    document.getElementById('init-video').addEventListener('click', () => {
        initVideo(); // Start the video stream
    });

    // Toggle between cameras when clicking the toggle button
    document.getElementById('toggle-camera').addEventListener('click', () => {
        toggleCamera(); // Toggle between front and rear cameras
    });

    // Stop the video when clicking the stop button
    document.getElementById('stop-video').addEventListener('click', () => {
        stopVideo(); // Stop the video stream
    });



  </script>


</body>
</html>






<!--/your-project
│
├── index.html
│
├── json
│   └── manifest.json
│
├── JS
│   ├── app.js
│   └── service-worker.js
│
├── Css
│   └── Mystyle.css
│
└── Asset
    └── Icon
        ├── icon-192x192.png
        └── icon-512x512.png
    -->
